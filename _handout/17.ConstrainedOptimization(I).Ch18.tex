% \documentclass[a4paper,11pt]{article}
% \usepackage[hyperref]{beamerarticle}

\documentclass[final]{beamer}

\usepackage{kotex}
\usepackage{amsfonts,amsmath,xob-amssymb}

\usepackage{amsthm}
\newtheorem{defn}{Definition}
\newtheorem{thm}{Theorem}

\usepackage{cancel}
\usepackage{enumerate}

\mode<presentation>{
	\usetheme{Madrid}
	\usecolortheme{default}
	\usefonttheme{professionalfonts}
}

\def\b{\boldsymbol}

\mode<article>{
\usepackage{fullpage}
}
\usepackage{ulem}

\newcommand{\bb}{\mathbb}
\newcommand{\bd}{\mathbf}
\newcommand{\p}{\partial}

\newcommand{\mail}{\url{econMath.namun+2016su@gmail.com}}

\author[조남운]{\mail}
\title{Constrained Optimization (I): FOC}
\subtitle{Ch.18}

\begin{document}
	
\maketitle

\mode<presentation>{
\begin{frame}[t]{Table of Contents}
	\tableofcontents
\end{frame}
%--- Next Frame ---%
}

\section{Constrained Optimization} % (fold)
\label{sec:constrained_optimization}
\begin{frame}[t]{Terms}
	\begin{block}
		{General Max(Min)imization Problem}
		\[
			\arg\max_{\bd{x}} f(\bd{x})\quad s.t.\quad \begin{cases}
				\bd{G}(\bd{x})\le\overline{\bd{b}}\\
				\bd{H}(\bd{x})=\overline{\bd{a}}
			\end{cases}
		\]
		\begin{itemize}
			\item $f$: Object function
			\item $\bd{G}(\bd{x})\le\overline{\bd{b}}$: Inequality Constraints
			\item $\bd{H}(\bd{x})=\overline{\bd{a}}$: Equality Constraints
		\end{itemize}
	\end{block}
	Note: From now on, we define inequality of vector as:\[
		G_i(\bd{x}) \le \bar{b}_i\quad \forall i
	\]
	Note2: For minimization problem, use $\arg\min$ instead.
\end{frame}
%--- Next Frame ---%
\begin{frame}[t]{Examples}
	\begin{block}
		{Utility Maximization Problem}
		\[
			\arg\max_{\bd{x}} U(\bd{x})\quad s.t. \quad \bd{p}\bullet \bd{x} \le Income \land \bd{x}\ge \bd{0}
		\]
		\begin{itemize}
			\item $U$: Utility function $\bd{x}$: consumption bundle $\bd{p}$: price vector
		\end{itemize}
	\end{block}
	\begin{block}
		{Profit Maximization Problem of a Competitive Firm}
		\[
			\arg\max_{\bd{x}} \Pi(\bd{x})
		\]\[
			\Pi(\bd{x}) := \bar p f(\bd{x}) - \bd{w}\bullet\bd{x},\quad \Pi\ge 0 \land \bd{x}\ge 0
		\]
		\begin{itemize}
			\item $f$: production function, $p$: price of final product
			\item $\bd{x}$: quantity bundle of factors for production
			\item $\bd{w}$: price vector of each factor
		\end{itemize}
	\end{block}
\end{frame}
%--- Next Frame ---%
% section constrained_optimization (end)
\section{Equality Constraints} % (fold)
\label{sec:equality_constraints}
\begin{frame}[t]{FOC of Constrained Max(Min)imization of $f:\bb{R}^2\rightarrow\bb{R}$}
	\begin{thm}
		[18.1] Let $f,h$ be $C^1$ functions of $\bd{x}\in\bb{R}^2$. Suppose $\bd{x^\ast}$ is a solution of the max(min)imization problem\[
			\arg\max_{\bd{x}} f(\bd{x}) \quad s.t. \quad h(\bd{x})=\bar a
		\] 
		If $\bd{x^\ast}$ is not a critical point of $h$, Then $\exists (\bd{x}^\ast,\mu^\ast)$ s.t. \[
			L(\bd{x},\mu):= f(\bd{x})+\mu(\bar{a}-h(\bd{x}))\quad\land\quad DL_{\bd{x},\mu}=\bd{0}
		\]
	\end{thm}
	Geometrically, $L$ (Lagrangian function) comes from the fact that if $\bd{x^\ast}$ is a solution of max(min)imization problem, then both gradient vectors of $f,h$ on $\bd{x^\ast}$ should be (1) perpendicular to the level sets of $f,h$ respectively and (2) the level sets of $f,h$ have the same slope at $\bd{x^\ast}$\[
		\exists \mu^\ast \quad s.t.\quad \nabla f (\bd{x^\ast}) = \mu^\ast \nabla h (\bd{x^\ast}) \quad \land\quad \nabla h(\bd{x^\ast})\neq\bd{0}
	\]
\end{frame}
%--- Next Frame ---%
\begin{frame}[t]{Constraint Qualification}
	\begin{block}
		{Constraint Qualification (CQ)}If $Dh_{\bd{x}}(\bd{x^\ast})=0$ ($i.e.,$ there is critical point of constraint function),  we cannot use Th 18.1. This consition is \uline{constraint qualification} (CQ). If we have points which can not pass the constraint qualification, we should include these points amont our candidates for a solution to the original constrained maximization problem, along with the critical points of $L$
	\end{block}
	\begin{block}
		{Nondegenerate CQ (NDCQ)} If there are $m$ equality constraints, NDCQ is $DH_{i\bd{x}}(\bd{x^\ast})\neq \bd{0}$ for all $i=1,\cdots,m$ and this means\[
			rank D\bd{H}_{\bd{x}}(\bd{x^\ast}) = m
		\]
	\end{block}
	Note: NDCQ is a regularity condition: passing NDCQ implies that the constraint set has a well-defined ($n-m$) dimensional tangent hyperplane at $\bd{x^\ast}$. 
\end{frame}
%--- Next Frame ---%
\begin{frame}[t]{FOCs of General Equality Constraints}
	We can extend Th 18.1 to general FOCs of constrained max(min)imization problem
	\begin{block}
		{General Max(Min)imization problem with Equality Constraints}
		\[
				\arg\max_{\bd{x}} f(\bd{x}) \quad s.t. \quad \bd{H}(\bd{x})=\bar{\bd{a}}
			\]
			Here equality constraints $\bd{H}(\bd{x})=\bar{\bd{a}}$ means:\[
				\begin{matrix}
					H_1(\bd{x})=a_1 \\
					\vdots\\
					H_m(\bd{x})=a_m
				\end{matrix}
			\]
	\end{block}

\end{frame}
%--- Next Frame ---%
\begin{frame}[t]{FOCs of General Equlaity Constraints}
	\begin{thm}
		[18.2] Let $f,\bd{H}$ be $C^1$ functions of $n$ variables ($i.e.,$ $\bd{x}\in\bb{R}^n$, $\bd{H}:\bb{R}^n\rightarrow\bb{R}^m$). Consider the max(min)imization problem with $m$ equality constraints:\[
			\arg\max_{\bd{x}} f(\bd{x}) \quad s.t.\quad \bd{H}(\bd{x})=\bar{\bd{a}}
		\]Suppose (1) $\bd{H}(\bd{x^\ast})=\bar{\bd{a}}$, (2) $\bd{x^\ast}$ is a local max (or min) of $f$ on $\bd{H}(\bd{x})=\bar{\bd{a}}$ and (3) $rank D\bd{H}_{\bd{x} }(\bd{x^\ast})=m$ (NDCQ). Then, $(\bd{x^\ast},\bd{\mu^\ast})\in{R}^{n+m}$ is a critical point of the Lagrangian\[
			L(\bd{x},\bd{\mu})=f(\bd{x})+\bd{\mu}(\bar{\bd{a}}-\bd{H}(\bd{x}))
		\]I.e.,\[
			DL_{\bd{x},\bd{\mu}}(\bd{x^\ast},\bd{\mu^\ast}) = \bd{0}
		\]
	\end{thm}
	Note: $\bd{\mu}=(\mu_1,\cdots,\mu_m)\in\bb{R}^m$
\end{frame}
%--- Next Frame ---%
% section equality_constraints (end)
\section{Inequality Constraints} % (fold)
\label{sec:inequality_constraints}
\begin{frame}[t]{One Inequality Constraints}
	\begin{block}
		{Inequality Constraints: Main Concept}
		Inequality constrained solution = [Equality Constrained solution] (corner solution, binding) or [Unconstrained solution] (internal solution, not binding)
	\end{block}
	\begin{thm}
		[18.3] $f,g$ are $C^1$ function on $\bb{R}^2$ and $\bd{x^\ast}$ max(min)imizes $f$ on the inequality constraint set $g(\bd{x})\le b$. If $g(\bd{x^\ast})=b$, and $Dg_{\bd{x}}(\bd{x^\ast})\neq \bd{0}$, There is a multiplier $\lambda^\ast$ satisfying:
		\begin{enumerate}
			\item $L(\bd{x},\lambda):=f(\bd{x})+\lambda(\bar{b}-g(\bd{x}))$
			\item $DL_{\bd{x},\lambda}(\bd{x^\ast},\lambda)=\bd{0}$
			\item $\lambda^\ast(\bar{b}-g(\bd{x^\ast}))=0$
			\item $\lambda^\ast\ge 0$
			\item $\bar{b}-g(\bd{x^\ast})\ge 0$
		\end{enumerate}
	\end{thm}
\end{frame}
%--- Next Frame ---%

\begin{frame}[t]{General Inequality Constraints}
	\begin{thm}
		[18.4] Suppose $f,\bd{G}$ are $C^1$ functions of $n$ variables ($\bd{G}:\bb{R}^n\rightarrow\bb{R}^k$). Suppose $\bd{x^\ast}\in\bb{R}^n$ is a local max(min)imizer of $f$ on the constraint set defined by the $k$  inequalities $\bd{G}\le \bar{\bd{b}}$. If (1) $k_0$ constraints are binding at $\bd{x^\ast}$ and the other $k-k_0$ constraints are not binding, and (2) $rank D\bd{G_0}_{\bd{x}}(\bd{x^\ast})= k_0$ ($\bd{G_0}$: binding inequality constraints) (NDCQ). Then, $\exists\bd{\lambda^\ast}$ satisfying:
		\begin{enumerate}
			\item $L(\bd{x},\bd{\lambda}):=f(\bd{x})+\bd{\lambda}(\bar{\bd{b}}-\bd{G}(\bd{x}))$
			\item $DL_{\bd{x}}(\bd{x^\ast,\lambda^\ast})=\bd{0}$
			\item $\bd{\lambda^\ast}(\bar{\bd{b}}-\bd{G}(\bd{x^\ast}))=\bd{0}$
			\item $\bd{\lambda}\ge 0$
			\item $\bar{\bd{b}}-\bd{G}(\bd{x^\ast})\ge 0$
		\end{enumerate}
	\end{thm}
	Note: $\bd{\lambda}:=(\lambda_1,\cdots,\lambda_k)\in \bb{R}^k$. When $i$th constraint is not binding, $\lambda_i=0$ (like unconstraint) and when $j$th constraint is binding, $\lambda_j> 0$ (like equality constraint). 
\end{frame}
%--- Next Frame ---%
% section inequality_constraints (end)
\section{Mixed Constraints} % (fold)
\label{sec:mixed_constraints}
\begin{frame}[t]{Mixed Constraints}
	\begin{thm}
		[18.5-1] Suppose $f,\bd{H},\bd{G}$ are $C^1$ functions of $n$ variables. Suppose $\bd{x}\in\bb{R}^n$ is a local max(min)imizer of $f$ on the constraint set defined $m$ equalities and $k$ inequalities:\[
			\arg\max_{\bd{x}}f(\bd{x}) \quad s.t.\quad \begin{cases}
				\bd{H(\bd{x})}=\bar{\bd{a}}\\
				\bd{G(\bd{x})}\le\bar{\bd{b}}
			\end{cases}
		\]
		Assume $k_0$ inequality constraints are binding at $\bd{x^\ast}$ and the other $k-k_0$ inequality constraints are not binding at $\bd{x^\ast}$. And suppose that NDCQ is satisfied ($\bd{G_0}$: binding inequality constraints):\[
			rank  D\begin{pmatrix}
				\bd{G_0}\\
				\bd{H}
			\end{pmatrix}_{\bd{x}}(\bd{x^\ast}) = k_0 + m
		\]
	\end{thm}
\end{frame}
%--- Next Frame ---%
\begin{frame}[t]{Mixed Constraints (2)}
	\begin{thm}
		[18.5-2] Then, $\exists \bd{\mu^\ast}\in\bb{R}^m,\bd{\lambda^\ast}\in\bb{R}^k$ satisfying:
		\begin{enumerate}
			\item $L(\bd{x},\bd{\mu},\bd{\lambda}):=f(\bd{x})+\bd{\mu}(\bar{\bd{a}}-\bd{H}(\bd{x}))+\bd{\lambda}(\bar{\bd{b}}-\bd{G(\bd{x})})$
			\item $DL_{\bd{x},\bd{\mu}}(\bd{x^\ast},\bd{\mu^\ast},\bd{\lambda^\ast})=\bd{0}$
			% \item $\bd{\mu^\ast}(\bar{\bd{a}}-\bd{H}(\bd{x^\ast}))=\bd{0}$
			\item $\bd{\lambda^\ast}(\bar{\bd{b}}-\bd{G}(\bd{x^\ast}))=\bd{0}$
			\item $\bd{\lambda^\ast}\ge \bd{0}$
			\item $\bar{\bd{b}}-\bd{G(\bd{x^\ast})}\ge \bd{0}$
		\end{enumerate}
	\end{thm}
	Note: When minimizing, the only difference is making $L:=f(\bd{x})+\bd{\mu}(\bar{\bd{a}}-\bd{H}(\bd{x}))-\bd{\lambda}(\bar{\bd{b}}-\bd{G(\bd{x})}$ (Equivalent to Th 18.6)
\end{frame}
%--- Next Frame ---%
% section mixed_constraints (end)
\section{Constrained Minimization Problems} % (fold)
\label{sec:constrained_minimization_problems}

% section constrained_minimization_problems (end)
\section{Kuhn-Tucker Formulation} % (fold)
\label{sec:kuhn_tucker_formulation}
\begin{frame}[t]{Kuhn-Tucker Formulation}
	\begin{block}
		{Kuhn-Tucker Formulation}
		\[
			\arg\max_\bd{x} f(\bd{x}) \quad s.t.\quad \bd{G}(\bd{x})\le \bar{\bd{b}} \quad\land\quad \bd{x}\ge 0
		\] When Considering Kuhn-Tucker Lagrangian\[
			\tilde{L}:=f(\bd{x})+\bd{\lambda}(\bar{\bd{b}}-\bd{G}(\bd{x}))
		\]
		FOCs are
		\begin{itemize}
			\item $D\tilde{L}_{\bd{x}}(\bd{x^\ast},\bd{\lambda^\ast})\le \bd{0}$
			\item $D\tilde{L}_{\bd{\lambda}}(\bd{x^\ast},\bd{\lambda^\ast})\ge \bd{0}$
			\item $x_i \frac{\p \tilde L}{\p x_i}(\bd{x^\ast,\lambda^\ast})=0$ for all $i$
			\item $\lambda_i \frac{\p \tilde L}{\p \lambda_i}(\bd{x^\ast,\lambda^\ast})=0$ for all $i$
		\end{itemize}
	\end{block}
	Note: Above lagrangian does not contains $n$ inequality constraints ($\bd{x}\ge 0$)
\end{frame}
%--- Next Frame ---%
% section kuhn_tucker_formulation (end)
\end{document}

